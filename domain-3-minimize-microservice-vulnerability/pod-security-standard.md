#### Enforce `baseline` level on the `development` namespace through the label `pod-security.kubernetes.io/enforce=baseline`.
```
ansible@nuc01:/tmp/privileged-pod-vul$ kubectl label --overwrite ns development  pod-security.kubernetes.io/enforce=baseline
```
The label is added to the namespace.
```
namespace/development labeled
```
#### Prepare pod configuration with `privileged` requirement and deploy. 
```
cat > cat privileged.yaml <<EOF
apiVersion: v1
kind: Pod
metadata:
  name: privileged
  namespace: development
spec:
  containers:
  - image: nginx
    name: demo-pod
    securityContext:
      privileged: true
EOF
ansible@nuc01:/tmp/privileged-pod-vul$ kubectl apply -f privileged.yaml
```

#### The pod security enforced and allowed only up to `baseline` level resulting in an error.


<details>
<summary>Output</summary>
```
Error from server (Forbidden): error when creating "privileged.yaml": pods "privileged" is forbidden: violates PodSecurity "baseline:latest": privileged (container "demo-pod" must not set securityContext.privileged=true)
ansible@nuc01:/tmp/privileged-pod-vul$ 
```
</details>

#### Edit label on the `development` namespace.
```
kubectl edit namespace development
```
#### Replace `pod-security.kubernetes.io/enforce=baseline` with `pod-security.kubernetes.io/audit=baseline` and save then proceed to redeploy the pod.

```
ansible@nuc01:/tmp/privileged-pod-vul$ kubectl apply -f privileged.yaml
```
#### It succeeded with the audit message indicating the security level has been breached.
<details>
<summary>Output</summary>

```
{"kind":"Event","apiVersion":"audit.k8s.io/v1","level":"Metadata","auditID":"c925888e-8614-4df3-8e1d-7c4e8099ed94","stage":"ResponseComplete","requestURI":"/api/v1/namespaces/development/pods?fieldManager=kubectl-client-side-apply\u0026fieldValidation=Strict","verb":"create","user":{"username":"kubernetes-admin","groups":["kubeadm:cluster-admins","system:authenticated"]},"sourceIPs":["192.168.0.150"],"userAgent":"kubectl/v1.31.0 (linux/amd64) kubernetes/9edcffc","objectRef":{"resource":"pods","namespace":"development","name":"privileged","apiVersion":"v1"},"responseStatus":{"metadata":{},"code":201},"requestReceivedTimestamp":"2024-12-19T08:43:23.919259Z","stageTimestamp":"2024-12-19T08:43:23.923464Z","annotations":{"authorization.k8s.io/decision":"allow","authorization.k8s.io/reason":"RBAC: allowed by ClusterRoleBinding \"kubeadm:cluster-admins\" of ClusterRole \"cluster-admin\" to Group \"kubeadm:cluster-admins\"","pod-security.kubernetes.io/audit-violations":"would violate PodSecurity \"baseline:latest\": privileged (container \"demo-pod\" must not set securityContext.privileged=true)","pod-security.kubernetes.io/enforce-policy":"privileged:latest"}}
```
</details>